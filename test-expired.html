<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>TimeFlow Card - Expired Timer Test</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
      background: #f5f5f5;
    }
    
    .test-container {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 20px;
      margin-bottom: 20px;
    }
    
    .card-container {
      background: white;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }
    
    h1, h2, h3 {
      color: #333;
    }
    
    .test-result {
      padding: 10px;
      margin: 5px 0;
      border-radius: 4px;
      font-weight: bold;
    }
    
    .test-result.pass {
      background: #d4edda;
      color: #155724;
      border: 1px solid #c3e6cb;
    }
    
    .test-result.fail {
      background: #f8d7da;
      color: #721c24;
      border: 1px solid #f5c6cb;
    }
  </style>
</head>
<body>
  <h1>TimeFlow Card - Expired Timer Test</h1>
  
  <div class="test-container">
    <div class="card-container">
      <h3>Test 1: Active Timer</h3>
      <timeflow-card id="activeCard"></timeflow-card>
      <p><strong>Expected:</strong> Title: "New Year Countdown", Subtitle: Time remaining</p>
    </div>
    
    <div class="card-container">
      <h3>Test 2: Expired Timer (Default Message)</h3>
      <timeflow-card id="expiredCard1"></timeflow-card>
      <p><strong>Expected:</strong> Title: "New Year Countdown", Subtitle: "Completed! ðŸŽ‰"</p>
    </div>
    
    <div class="card-container">
      <h3>Test 3: Expired Timer (Custom Message)</h3>
      <timeflow-card id="expiredCard2"></timeflow-card>
      <p><strong>Expected:</strong> Title: "Birthday Party", Subtitle: "Happy Birthday! ðŸŽ‚ðŸŽˆ"</p>
    </div>
  </div>

  <div id="test-results">
    <h2>Test Results:</h2>
  </div>

  <!-- Load TimeFlow Card -->
  <script src="timeflow-card.js"></script>
  
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const results = document.getElementById('test-results');
      const activeCard = document.getElementById('activeCard');
      const expiredCard1 = document.getElementById('expiredCard1');
      const expiredCard2 = document.getElementById('expiredCard2');
      
      function addResult(test, pass, message) {
        const div = document.createElement('div');
        div.className = `test-result ${pass ? 'pass' : 'fail'}`;
        div.textContent = `${pass ? 'âœ“' : 'âœ—'} ${test}: ${message}`;
        results.appendChild(div);
      }
      
      try {
        // Test 1: Active timer
        activeCard.setConfig({
          target_date: "2025-12-31T23:59:59",
          title: "New Year Countdown",
          width: "300px",
          height: "180px",
          background_color: "#1976d2"
        });
        
        // Test 2: Expired timer with default message
        expiredCard1.setConfig({
          target_date: "2024-01-01T00:00:00", // Past date
          title: "New Year Countdown",
          width: "300px",
          height: "180px",
          background_color: "#4CAF50"
        });
        
        // Test 3: Expired timer with custom message
        expiredCard2.setConfig({
          target_date: "2024-06-15T00:00:00", // Past date
          title: "Birthday Party",
          expired_text: "Happy Birthday! ðŸŽ‚ðŸŽˆ",
          width: "300px",
          height: "180px",
          background_color: "#FF5722"
        });
        
        addResult('Card Configuration', true, 'All cards configured successfully');
        
        // Wait for initial render and check content
        setTimeout(() => {
          // Test active card
          const activeTitle = activeCard.shadowRoot?.querySelector('.title');
          const activeSubtitle = activeCard.shadowRoot?.querySelector('.subtitle');
          
          if (activeTitle && activeSubtitle) {
            const activeTitleCorrect = activeTitle.textContent === "New Year Countdown";
            const activeSubtitleHasTime = !activeSubtitle.textContent.includes('Completed') && 
                                         !activeSubtitle.textContent.includes('expired');
            
            addResult('Active Card Title', activeTitleCorrect, 
              activeTitleCorrect ? 'Correct' : `Got: "${activeTitle.textContent}"`);
            addResult('Active Card Subtitle', activeSubtitleHasTime, 
              activeSubtitleHasTime ? 'Shows time remaining' : `Got: "${activeSubtitle.textContent}"`);
          }
          
          // Test expired card 1 (default message)
          const expired1Title = expiredCard1.shadowRoot?.querySelector('.title');
          const expired1Subtitle = expiredCard1.shadowRoot?.querySelector('.subtitle');
          
          if (expired1Title && expired1Subtitle) {
            const expired1TitleCorrect = expired1Title.textContent === "New Year Countdown";
            const expired1SubtitleCorrect = expired1Subtitle.textContent === "Completed! ðŸŽ‰";
            
            addResult('Expired Card 1 Title', expired1TitleCorrect, 
              expired1TitleCorrect ? 'Correct (unchanged)' : `Got: "${expired1Title.textContent}"`);
            addResult('Expired Card 1 Subtitle', expired1SubtitleCorrect, 
              expired1SubtitleCorrect ? 'Shows default expired text' : `Got: "${expired1Subtitle.textContent}"`);
          }
          
          // Test expired card 2 (custom message)
          const expired2Title = expiredCard2.shadowRoot?.querySelector('.title');
          const expired2Subtitle = expiredCard2.shadowRoot?.querySelector('.subtitle');
          
          if (expired2Title && expired2Subtitle) {
            const expired2TitleCorrect = expired2Title.textContent === "Birthday Party";
            const expired2SubtitleCorrect = expired2Subtitle.textContent === "Happy Birthday! ðŸŽ‚ðŸŽˆ";
            
            addResult('Expired Card 2 Title', expired2TitleCorrect, 
              expired2TitleCorrect ? 'Correct (unchanged)' : `Got: "${expired2Title.textContent}"`);
            addResult('Expired Card 2 Subtitle', expired2SubtitleCorrect, 
              expired2SubtitleCorrect ? 'Shows custom expired text' : `Got: "${expired2Subtitle.textContent}"`);
          }
        }, 500);
        
      } catch (error) {
        addResult('Configuration Error', false, error.message);
      }
    });
  </script>
</body>
</html>
